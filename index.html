<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA-Camara</title>
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#317EFB" />
    <link rel="stylesheet" href="./index.css">
    <script src="https://cdn.jsdelivr.net/npm/pouchdb@9.0.0/dist/pouchdb.min.js"></script>
    <style>
        
    </style>
</head>
<body>
    <h1>PWA con Cámara</h1>

    <div id="controls">
        <button id="openCamera">Abrir la Cámara</button>
        <button id="toggleCamera" class="secondary">Cambiar Cámara</button>
        <button id="takePhoto" class="secondary">Tomar Foto</button>
        <button id="clearGallery" class="secondary">Limpiar Galería</button>
    </div>

    <div id="cameraContainer">
        <video id="video" autoplay playsinline width="320" height="240"></video>
    </div>

    <canvas id="canvas" width="480" height="640"></canvas>

    <div id="galleryWrap">
        <div id="gallery"></div>
    </div>

    <div id="toast-msg" style="position: fixed;
        left: 50%;
        bottom: 24px;
        transform: translateX(-50%);
        background: #222;
        color: #fff;
        padding: 10px 14px;
        border-radius: 14px;
        font-size: 0.95rem;
        box-shadow: 0 2px 10px #0004;
        z-index: 99999;
        display: none;
        transition: opacity 0.3s;">
    </div>

    <div id="connection-status"
        style="position: fixed; bottom: 0; left: 0; right: 0; z-index: 9999; text-align: center; font-weight: bold; font-size: 0.8rem; padding: 8px 0; display: none; transition: background 0.3s;">
    </div>

    <script>
        function setConnectionOutline(isOnline) {
            document.body.classList.remove('online', 'offline');
            if (isOnline) {
                document.body.classList.add('online');
                const bar = document.getElementById('connection-status');
                bar.style.background = '#28a745';
                bar.style.color = '#fff';
                bar.textContent = 'Online';
                bar.style.display = 'block';
                setTimeout(() => { bar.style.display = 'none'; }, 2000);
            } else {
                document.body.classList.add('offline');
                const bar = document.getElementById('connection-status');
                bar.style.background = '#dc3545';
                bar.style.color = '#fff';
                bar.textContent = 'Offline';
                bar.style.display = 'block';
            }
        }
        setConnectionOutline(navigator.onLine);
        window.addEventListener('online', () => setConnectionOutline(true));
        window.addEventListener('offline', () => setConnectionOutline(false));
    </script>

    <script src="./app.js"></script>
</body>
</html>